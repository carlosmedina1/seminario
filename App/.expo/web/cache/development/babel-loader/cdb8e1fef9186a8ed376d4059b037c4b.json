{"ast":null,"code":"import _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nimport _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport React, { useState, useEffect, useCallback, useReducer } from 'react';\nimport View from \"react-native-web/dist/exports/View\";\nimport StyleSheet from \"react-native-web/dist/exports/StyleSheet\";\nimport Text from \"react-native-web/dist/exports/Text\";\nimport ActivityIndicator from \"react-native-web/dist/exports/ActivityIndicator\";\nimport Alert from \"react-native-web/dist/exports/Alert\";\nimport StatusBar from \"react-native-web/dist/exports/StatusBar\";\nimport TouchableOpacity from \"react-native-web/dist/exports/TouchableOpacity\";\nimport FlatList from \"react-native-web/dist/exports/FlatList\";\nimport TextInput from \"react-native-web/dist/exports/TextInput\";\nimport Image from \"react-native-web/dist/exports/Image\";\nimport Dimensions from \"react-native-web/dist/exports/Dimensions\";\nimport Modal from \"../components/customModal\";\nimport * as Animatable from 'react-native-animatable';\nimport { LinearGradient } from 'expo-linear-gradient';\nimport MaterialIcons from \"@expo/vector-icons/MaterialIcons\";\nimport * as SQLite from 'expo-sqlite';\nimport AsyncStorage from '@react-native-async-storage/async-storage';\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nvar windowHeight = Dimensions.get('screen').height;\nvar styles = StyleSheet.create({\n  container: {\n    flex: 1,\n    alignItems: 'center',\n    justifyContent: 'center',\n    backgroundColor: '#fff',\n    minHeight: Math.round(windowHeight)\n  },\n  image: {\n    width: '100%',\n    height: '100%',\n    position: 'absolute',\n    opacity: 0.3\n  },\n  header: {\n    flex: 1,\n    width: '100%',\n    height: '100%'\n  },\n  action: {\n    flexDirection: 'row',\n    width: '100%',\n    backgroundColor: '#fff',\n    borderRadius: 10,\n    paddingTop: 10,\n    paddingLeft: 10,\n    paddingRight: 10,\n    paddingBottom: 10,\n    borderWidth: 1,\n    borderColor: 'lightgray',\n    shadowColor: '#000',\n    shadowOffset: {\n      width: 0,\n      height: 2\n    },\n    shadowOpacity: 0.2,\n    shadowRadius: 8,\n    elevation: 10\n  },\n  body: {\n    flex: 10,\n    width: '100%',\n    alignItems: 'center',\n    justifyContent: 'center'\n  },\n  card: {\n    backgroundColor: '#fff',\n    width: '100%'\n  },\n  itemContainer: {\n    margin: 10,\n    padding: 10,\n    backgroundColor: '#fff',\n    borderRadius: 10,\n    flexDirection: 'row',\n    alignItems: 'center',\n    shadowColor: '#000',\n    shadowOffset: {\n      width: 0,\n      height: 2\n    },\n    shadowOpacity: 0.2,\n    shadowRadius: 8,\n    elevation: 10\n  },\n  footer: {\n    flex: 0.5,\n    width: '100%',\n    height: '100%'\n  }\n});\nvar bd = SQLite.openDatabase('localhost.db', '1.0');\nexport default function faenas(_ref) {\n  var navigation = _ref.navigation;\n\n  var _useState = useState([]),\n      _useState2 = _slicedToArray(_useState, 2),\n      faenas = _useState2[0],\n      setFaenas = _useState2[1];\n\n  var _useState3 = useState([]),\n      _useState4 = _slicedToArray(_useState3, 2),\n      filterFaenas = _useState4[0],\n      setFilterFaenas = _useState4[1];\n\n  var _useState5 = useState(''),\n      _useState6 = _slicedToArray(_useState5, 2),\n      busqueda = _useState6[0],\n      setBusqueda = _useState6[1];\n\n  var _useState7 = useState(true),\n      _useState8 = _slicedToArray(_useState7, 2),\n      loading = _useState8[0],\n      setLoading = _useState8[1];\n\n  var filtrarFaena = function filtrarFaena(text) {\n    if (text) {\n      var newData = faenas.filter(function (item) {\n        var itemData = item.nombre_faena + item.nombre_comuna;\n        var textData = text.toUpperCase();\n        return itemData.indexOf(textData) > -1;\n      });\n      setFilterFaenas(newData);\n      setBusqueda(text);\n    } else {\n      setFilterFaenas(faenas);\n      setBusqueda(text);\n    }\n  };\n\n  var goVehiculos = function goVehiculos(item) {\n    console.log(item.id_faena);\n    navigation.navigate('VehiculoFaena', {\n      idFaena: item.id_faena\n    });\n  };\n\n  var getFaenas = function getFaenas() {\n    var usuario;\n    return _regeneratorRuntime.async(function getFaenas$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            _context.next = 2;\n            return _regeneratorRuntime.awrap(AsyncStorage.getItem('user'));\n\n          case 2:\n            usuario = _context.sent;\n            bd.transaction(function (tx) {\n              tx.executeSql(\"select f.id_faena, f.nombre_faena, c.nombre_comuna from faena f join comuna c on c.id_comuna = f.id_comuna join trabajador t on t.id_trabajador = f.id_trabajador join usuario u on u.id_trabajador = t.id_trabajador group by f.id_faena, c.nombre_comuna;\", [], function (tx, res) {\n                var array = res.rows._array;\n                console.log(array);\n                var noDuplicate = array.filter(function (value, index, self) {\n                  return index === self.findIndex(function (item) {\n                    return item.id_faena === value.id_faena && item.nombre_faena === item.nombre_faena;\n                  });\n                });\n                setFaenas(noDuplicate);\n                setFilterFaenas(noDuplicate);\n                setLoading(false);\n              }, function (tx, e) {\n                console.error(e);\n              });\n            });\n\n          case 4:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, null, null, null, Promise);\n  };\n\n  useEffect(function () {\n    getFaenas();\n  }, []);\n  console.log(faenas, filterFaenas);\n  return _jsxs(View, {\n    style: styles.container,\n    children: [_jsx(StatusBar, {\n      barStyle: \"dark-content\",\n      translucent: true,\n      backgroundColor: \"transparent\"\n    }), _jsx(View, {\n      style: styles.header\n    }), _jsx(Animatable.View, {\n      animation: 'fadeInUpBig',\n      style: styles.body,\n      children: _jsx(View, {\n        style: styles.card,\n        children: _jsxs(View, {\n          style: {\n            paddingLeft: 20,\n            paddingRight: 20,\n            justifyContent: 'center'\n          },\n          children: [_jsx(Text, {\n            style: {\n              fontSize: 30,\n              fontWeight: 'bold',\n              color: '#000',\n              marginBottom: 10\n            },\n            children: \"Faenas\"\n          }), _jsxs(View, {\n            style: styles.action,\n            children: [_jsx(MaterialIcons, {\n              color: \"gray\",\n              name: \"search\",\n              size: 20,\n              style: {\n                flex: 1,\n                marginRight: 10,\n                alignSelf: 'center'\n              }\n            }), _jsx(TextInput, {\n              placeholder: \"Buscar Faena\",\n              style: {\n                width: '100%',\n                flex: 10\n              },\n              onChangeText: function onChangeText(text) {\n                return filtrarFaena(text);\n              },\n              value: busqueda\n            })]\n          }), loading ? _jsx(ActivityIndicator, {\n            size: 'large',\n            color: \"#000\",\n            style: {\n              alignSelf: 'center',\n              flex: 1\n            }\n          }) : _jsx(FlatList, {\n            data: filterFaenas,\n            keyExtractor: function keyExtractor(x) {\n              return filterFaenas.indexOf(x);\n            },\n            renderItem: function renderItem(_ref2) {\n              var item = _ref2.item;\n              return _jsx(View, {\n                name: 'fadeInUpBig',\n                style: styles.itemContainer,\n                children: _jsxs(TouchableOpacity, {\n                  onPress: function onPress() {\n                    return goVehiculos(item);\n                  },\n                  children: [_jsxs(View, {\n                    style: {\n                      flexDirection: 'row',\n                      width: '100%',\n                      marginBottom: 5\n                    },\n                    children: [_jsx(MaterialIcons, {\n                      name: \"fiber-manual-record\",\n                      color: \"#5dd069\",\n                      size: 10,\n                      style: {\n                        alignSelf: 'center',\n                        marginRight: 5\n                      }\n                    }), _jsx(Text, {\n                      style: {\n                        fontSize: 14,\n                        fontWeight: 'bold',\n                        color: '#000'\n                      },\n                      children: item.nombre_faena\n                    })]\n                  }), _jsx(View, {\n                    style: {\n                      width: 100,\n                      backgroundColor: '#000',\n                      borderRadius: 50,\n                      padding: 5,\n                      alignItems: 'center',\n                      justifyContent: 'center'\n                    },\n                    children: _jsx(Text, {\n                      numberOfLines: 1,\n                      style: {\n                        fontSize: 10,\n                        fontWeight: 'bold',\n                        color: '#fff'\n                      },\n                      children: item.nombre_comuna\n                    })\n                  })]\n                })\n              });\n            },\n            style: {\n              height: '100%'\n            }\n          }, function (x) {\n            return filterFaenas.indexOf(x);\n          })]\n        })\n      })\n    })]\n  });\n}","map":{"version":3,"sources":["/Users/datamaule/workspace/miSupervisor/App/src/Faenas.js"],"names":["React","useState","useEffect","useCallback","useReducer","Modal","Animatable","LinearGradient","MaterialIcons","SQLite","AsyncStorage","windowHeight","Dimensions","get","height","styles","StyleSheet","create","container","flex","alignItems","justifyContent","backgroundColor","minHeight","Math","round","image","width","position","opacity","header","action","flexDirection","borderRadius","paddingTop","paddingLeft","paddingRight","paddingBottom","borderWidth","borderColor","shadowColor","shadowOffset","shadowOpacity","shadowRadius","elevation","body","card","itemContainer","margin","padding","footer","bd","openDatabase","faenas","navigation","setFaenas","filterFaenas","setFilterFaenas","busqueda","setBusqueda","loading","setLoading","filtrarFaena","text","newData","filter","item","itemData","nombre_faena","nombre_comuna","textData","toUpperCase","indexOf","goVehiculos","console","log","id_faena","navigate","idFaena","getFaenas","getItem","usuario","transaction","tx","executeSql","res","array","rows","_array","noDuplicate","value","index","self","findIndex","e","error","fontSize","fontWeight","color","marginBottom","marginRight","alignSelf","x"],"mappings":"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","sourcesContent":["import React, { useState, useEffect, useCallback, useReducer } from 'react'\nimport {View, StyleSheet, Text, ActivityIndicator, Alert, StatusBar, TouchableOpacity, FlatList, TextInput, Image, Dimensions, } from 'react-native'\nimport Modal from '../components/customModal'\n\nimport * as Animatable from 'react-native-animatable'\nimport {LinearGradient} from 'expo-linear-gradient'\nimport MaterialIcons from 'react-native-vector-icons/MaterialIcons'\n\nimport * as SQLite from 'expo-sqlite'\nimport AsyncStorage from '@react-native-async-storage/async-storage'\n\nconst windowHeight = Dimensions.get('screen').height;\n\nconst styles = StyleSheet.create({\n    container: {\n        flex: 1,\n        alignItems: 'center',\n        justifyContent: 'center',\n        backgroundColor: '#fff',\n        minHeight: Math.round(windowHeight)\n    },\n\n    image: {\n        width: '100%',\n        height: '100%',\n        position: 'absolute',\n        opacity: 0.3,\n    },\n    \n    header: {\n        flex: 1,\n        width: '100%',\n        height: '100%',\n    },\n\n    action: {\n        flexDirection: 'row',\n        width: '100%',\n        backgroundColor: '#fff',\n        borderRadius: 10,\n        paddingTop: 10,\n        paddingLeft: 10,\n        paddingRight: 10,\n        paddingBottom: 10,\n        borderWidth: 1,\n        borderColor: 'lightgray',\n\n        shadowColor: '#000',\n        shadowOffset: { width: 0, height: 2 },\n        shadowOpacity: 0.2,\n        shadowRadius: 8,\n        elevation: 10,\n    },\n\n    body: {\n        flex: 10,\n        width: '100%',\n        alignItems: 'center',\n        justifyContent: 'center',\n        //backgroundColor: 'red',\n    },\n\n    card: {\n        backgroundColor: '#fff',\n        width: '100%',\n    },\n\n    itemContainer: {\n        margin: 10,\n        padding: 10,\n        backgroundColor: '#fff',\n        borderRadius: 10,\n        flexDirection: 'row',\n        alignItems: 'center',\n\n        shadowColor: '#000',\n        shadowOffset: { width: 0, height: 2 },\n        shadowOpacity: 0.2,\n        shadowRadius: 8,\n        elevation: 10,\n    },\n\n    footer: {\n        flex: 0.5,\n        width: '100%',\n        height: '100%',\n        //backgroundColor: 'red'\n    },\n})\n\nconst bd = SQLite.openDatabase('localhost.db','1.0')\n\nexport default function faenas({navigation}) {\n    const [faenas, setFaenas] = useState([])\n    const [filterFaenas, setFilterFaenas] = useState([])\n    \n    const [busqueda, setBusqueda] = useState('')\n    const [loading, setLoading] = useState(true)\n\n    const filtrarFaena = (text) => {\n        if(text){\n            const newData = faenas.filter((item) => {\n                const itemData = item.nombre_faena+item.nombre_comuna\n                const textData = text.toUpperCase();\n\n                return itemData.indexOf(textData) > -1;\n            })\n    \n            setFilterFaenas(newData)\n            setBusqueda(text)\n        }\n        else {\n            setFilterFaenas(faenas)\n            setBusqueda(text)\n        }\n    }\n\n    const goVehiculos = (item) => {\n        console.log(item.id_faena)\n        navigation.navigate('VehiculoFaena', {\n            idFaena: item.id_faena\n        })\n    }\n\n    const getFaenas = async() => {\n        const usuario = await AsyncStorage.getItem('user')\n\n        bd.transaction(tx => {\n            tx.executeSql(\n                \"select f.id_faena, f.nombre_faena, c.nombre_comuna from faena f join comuna c on c.id_comuna = f.id_comuna join trabajador t on t.id_trabajador = f.id_trabajador join usuario u on u.id_trabajador = t.id_trabajador group by f.id_faena, c.nombre_comuna;\", \n                [],\n                (tx, res) => {\n                    const array = res.rows._array\n                    console.log(array)\n                    const noDuplicate = array.filter((value, index, self) =>\n                        index === self.findIndex((item) => (\n                            item.id_faena === value.id_faena && \n                            item.nombre_faena === item.nombre_faena\n                        ))\n                    )\n\n                    setFaenas(noDuplicate)\n                    setFilterFaenas(noDuplicate)\n                    setLoading(false)\n                },\n                (tx, e) => {\n                    console.error(e)\n                }\n            )\n        })\n    }\n\n    useEffect(() => {\n        getFaenas()\n    }, [])\n\n    console.log(faenas, filterFaenas)\n    \n    return (\n        <View style={styles.container}>\n            <StatusBar barStyle = 'dark-content' translucent backgroundColor=\"transparent\"/>\n\n            <View style={styles.header}/>\n\n            <Animatable.View animation={'fadeInUpBig'} style={styles.body}>\n                <View style={styles.card}>\n                    <View style={{paddingLeft: 20, paddingRight: 20, justifyContent: 'center'}}>\n                        <Text style={{fontSize: 30, fontWeight: 'bold', color: '#000', marginBottom: 10,}}>Faenas</Text>\n                        <View style={styles.action}>\n                        <MaterialIcons color=\"gray\" name=\"search\" size={20} style={{flex: 1, marginRight: 10, alignSelf: 'center'}}/>\n                            <TextInput \n                                placeholder=\"Buscar Faena\" \n                                style={{width: '100%', flex: 10}} \n                                onChangeText = {(text) => filtrarFaena(text)}\n                                value={busqueda}/>\n                        </View>\n\n                        {loading ? (\n                            <ActivityIndicator size={'large'} color='#000' style={{alignSelf: 'center', flex: 1}}/>\n                        ) : (\n                            <FlatList\n                                data={filterFaenas}\n                                key={(x) => filterFaenas.indexOf(x)}\n                                keyExtractor={(x) => filterFaenas.indexOf(x)}\n                                renderItem={({item}) => (\n                                    <View name={'fadeInUpBig'} style={styles.itemContainer}>\n                                        <TouchableOpacity onPress={() => goVehiculos(item)}>\n                                            <View style={{flexDirection: 'row', width: '100%', marginBottom: 5,}}>\n                                                <MaterialIcons name=\"fiber-manual-record\" color=\"#5dd069\" size={10} style={{alignSelf: 'center', marginRight: 5}}/>\n                                                <Text style={{fontSize: 14, fontWeight: 'bold', color: '#000'}}>{item.nombre_faena}</Text>\n                                            </View>\n                                            <View style={{width: 100, backgroundColor: '#000', borderRadius: 50, padding: 5, alignItems: 'center', justifyContent: 'center'}}>\n                                                <Text numberOfLines={1} style={{fontSize: 10, fontWeight: 'bold', color: '#fff',}}>{item.nombre_comuna}</Text>\n                                            </View>\n                                        </TouchableOpacity>\n                                    </View>\n                                )}\n                                style={{height: '100%'}}\n                            />\n                        )}\n                    </View>\n                </View>\n            </Animatable.View>\n        </View>\n    )\n}"]},"metadata":{},"sourceType":"module"}